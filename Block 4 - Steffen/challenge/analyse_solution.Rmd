---
title: "Rechtsextreme Aufmärsche in Deutschland"
author: "Autoren: Teilnehmer des ifp Coding Bootcamps"
date: "Letze Aktualisierung: `r format(Sys.time(), '%d.%m.%Y')`"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  echo = F,
  warning = F,
  message = F
)
```

<style>
@import url('https://fonts.googleapis.com/css?family=Fira+Sans&display=swap');
body {
  font-family: "Fira Sans", sans-serif;
  font-size: 1.6em;
  color: #666666;
  line-height: 1.6;
  -webkit-hyphens: auto;
  -moz-hyphens: auto;
  -ms-hyphens: auto;
  hyphens: auto;
}

h1 {
  color: #DF6233;
}

h2, h3 {
  color: #DF6233;
  margin-top: 3em;
}

a {
  color: #006CAB;
}
</style>

```{r}
library(tidyverse)
library(lubridate)

source("utils/theme_ifp.R")
theme_set(theme_ifp())

## Tabelle laden und richtige Spaltenformate setzen
data <- read_csv(
  "data/rechtsextreme_aufmaersche.csv",
  col_types = cols(
    .default = col_character(),
    Datum = col_date(format = "%d.%m.%Y"),
    Teilnehmer = col_integer()
  )
)

## Eigene Spalten für Jahr und Monat hinzufügen
data <- data %>%
  mutate(
    Jahr = year(Datum),
    Monat = month(Datum)
  )
```

### Welche rechtsextreme Gruppe oder Partei hat die meisten Aufmärsche organisiert?

Insgesamt haben rechte Organisation `r data %>% summarise(Anzahl = n()) %>% first()` Aufmärsche im Zeitraum von Oktober 2013 bis September 2019 organisiert. Ein großer Teil der Veranstaltungen wurde jedoch von Bürgerbündnissen und Einzelpersonen organisiert.

```{r}
data %>%
  group_by(Kategorie) %>%
  summarise(Anzahl = n()) %>%
  arrange(desc(Anzahl)) %>%
  ggplot(aes(x = reorder(Kategorie, -Anzahl), y = Anzahl)) +
  geom_bar(stat = "identity", fill = "#006CAB") +
  xlab(label = "Partei oder Gruppierung")
```

Die rechtsextreme Altpartei NPD organisierte immerhin `r data %>% filter(Kategorie == "NPD") %>% summarise(Anzahl = n()) %>% first()` Aufmärschen. Die 2012 gegründete neonazistische Partei „Die Rechte“ organisierte im gleichen Zeitraum `r data %>% filter(Kategorie == "Die Rechte") %>% summarise(Anzahl = n()) %>% first()` Protestmärsche. Die rechtsextreme Partei „Der III. Weg“ wurde 2013 gegründet und richte bisher `r data %>% filter(Kategorie == "III. Weg") %>% summarise(Anzahl = n()) %>% first()` Demos aus.

### Welche rechtsextreme Gruppe oder Partei hat die meisten Aufmärsche *pro Jahr* organisiert?

### Welche rechtsextreme Gruppe oder Partei hat die meisten Teilnehmer zusammengebracht?

### Welche rechtsextreme Gruppe oder Partei hat die meisten Teilnehmer *pro Jahr* zusammengebracht?

### Gibt es einen Zusammenhang zwischen der Anzahl an Aufmärschen und den Teilnehmerzahlen?

### In welchem Jahr gab es die meisten rechtsextremen Aufmärsche?

### In welchem Monat gab es die meisten rechtsextremen Aufmärsche?

### Wie hat sich die Zahl der rechtsextremen Aufmärsche entwickelt?

```{r}
data %>%
  group_by(Jahr) %>%
  summarise(Anzahl = sum(n())) %>%
  ggplot(aes(x = factor(Jahr), y = Anzahl, group = 1)) +
  geom_line() +
  geom_point() +
  scale_color_brewer(palette = "Set1") +
  xlab(label = "Jahr")
```

### Wie hat sich die Zahl der rechtsextremen Aufmärsche *pro Partei* entwickelt?

```{r}
data %>%
  group_by(Kategorie, Jahr) %>%
  summarise(Anzahl = sum(n())) %>%
  ggplot(aes(x = factor(Jahr), y = Anzahl)) +
  geom_line(aes(group = Kategorie, color = Kategorie)) +
  geom_point(aes(group = Kategorie, color = Kategorie)) +
  scale_color_brewer(palette = "Set1") +
  ggtitle("Rechtsextreme Aufmärsche pro Organisation und Jahr") +
  xlab(label = "Jahr")
```

### Wie hat sich die Zahl der rechtsextremen Aufmärsche *in den einzelnen Bundesländern* entwickelt?

```{r}
data %>%
  na.omit() %>%
  group_by(Bundesland, Jahr) %>%
  summarise(Anzahl = sum(n())) %>%
  ggplot(aes(x = Jahr, y = Anzahl, group = Bundesland, color = Bundesland)) +
  geom_line(show.legend = FALSE) +
  facet_wrap(~ Bundesland) +
  scale_x_discrete(limits = c(2014, 2019)) +
  # scale_x_date(date_breaks = '2 years', date_labels = '%Y') +
  # scale_x_continuous(breaks = seq(2014, 2016, 2018)) +
  xlab(label = "")
```








